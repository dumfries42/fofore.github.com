---
layout: post
title: 拒绝人工对比
category: 
---

今天接到一个简单的任务:

>对比两张excel表格,两个表包含了同一些事物的不同的属性.这些事物是顺序完全是不同的,唯一共同点就是每行的事物名.需要把这些属性归纳到一个表里面去.

属于我的任务其实不多,一共27+5个条目要去对比,其实用眼睛加上灵活的鼠标和键盘操作30分钟基本能够搞定.但是我非常懒,主要还是怕烦,怕这种人工对比的活儿,不要使用大脑,只在大脑里面机械重复的使用短期记忆-这边拍个照,那边看看像不像,回头再瞄一瞄.这样下去脑袋肯定会废掉.

对于程序员,处理这些文字,数字的活儿,尤其是需要人工对比的活儿.必须有个长期解决的方案.初步方案如下:

* 第一步选定解决的工具: python (因为目前为止我只会这个)
* **然后把excel转为csv** csv是纯文本的,而且python有现成的支持csv的库
* **编写python脚本循环读取csv文件,进行对比**
* **在拷贝相应的属性到目标文件** 这个时候生成的还是csv文件
* 最后还需要在excel应用程序中打开csv文件,整块的拷贝到excel文件中

其实最后节省的就只是对比的工作.但是这是非常值得的,那种工作对脑力的耗费是相当大的,令人昏昏欲睡.

我最后只写了一个对我自己工作的简单的排序脚本,而且效率很差,只是达到了能用的效果,之后要做的是参数化,以及提高效率.就现在来看,cpu对比我今天这几条数据,就是"su"的一声就干完了.

下面是简单代码,我会不断更新,直到放出普遍能用的版本:

    import csv
    
    line1 = 2
    line2 = 4
    line3 = 1
    line4 = 13
    
    reader = csv.reader(open("src_a.csv"))
    writer = csv.writer(open("dst.csv", 'wb')) //加b,避免csv多空行
    
    for row in reader:
        for row1 in csv.reader(open("src_b.csv")):
            if row[line1-1] == row1[line2-1]:
                row[line4-1] = row1[line3 - 1]
        writer.writerow(row)

代码就不一一解释了,只是提供一个思路来对付对于这些机械的人工对比.

其中还有一点不明白,就是为什么在打开写文件时候要加b选项,否则每条csv条目后就多了一个空行,回头读一读文档或者源码看看.

另外,今天还改变了这里的背景,加上了页尾,还学会了怎么改css文件,而不是都照搬别人的文件了.原来在chrome和firefox中就可以直接修改css看效果,效果好就可以写到css文件中去.

